---
widget: xl
layout: task-tab
title: Retrieving fills
AccordionID: xl-retrieving-fills
---
<p>The TT RTD Server allows you to retrieve information about working fills, such as the columns available in the Fills widgets, using an RTD formula.</p>

<section id="os">
	<h2>Working with fill sets</h2>
	<p>An RTD Server application accesses order and fill data through an order set. An order set represents a view into the order book, a subsection of all the orders you place in the market. When you create an order set, you create a set of selection rules, called an order selector, that identifies which of the current orders you want to include in the set. For example, you might create one order set that contains all U.S. 30-Year Treasury Bond (ZB) orders and another order set that contains all buy orders. Also, individual orders can appear in multiple order sets.</p>

	<p>The following illustration shows three order sets that provide different views into the whole order
		book.</p>

	<p><img class="img-responsive" src="Content/xl-os-filter-example.png" alt="" /></p>

	<p>The RTD formula for getting an order set ID uses the following format.</p>
	<!-- -->
	<blockquote>
		<pre>=RTD("tt.rtd",,"OS",<i>order-property</i>,<i>order-property</i> ...)</pre>
	</blockquote>
	<!-- -->
	<p>where each <i>order-property</i> indicates an Order Book column name and value to include in the order filtering criteria.</p>

	<p><b>Notes</b>: </p>
	<ul>
		<li>
			The second parameter is the name of the external server running the RTD Server. As the TT RTD Server always runs locally, you must omit a value for the second parameter or supply an empty string (“”). However, you must account for the parameter in the formula.
		</li>
		<li>
			The <i>order-property</i> parameter can be any property available in the <a href="ob-reference.html#ob-col-desc">Order Book columns</a>, as well as any input and output parameters of an algo order.
		</li>
		<li>
			The name and value of each property must match exactly, including capitals, spaces, and special characters.
		</li>
	</ul>

	<!--
	<p>The <i>order-property</i> parameter can be any property available in the <a href="ob-reference.html#ob-col-desc">Order Book columns</a>, as well as any input and output parameters of an algo order.</p>
	<p>Note: The name of the property must match exactly, including capitals, spaces, and special characters.</p>
 -->

	<p>For example, to create an order set that includes all orders for the ES product on the CME exchange using account ABCDEF, you would enter the following RTD formula:</p>
	<!-- -->
	<blockquote>
		<pre>=RTD("tt.rtd",,"OS","Exch=CME","Product=ES","Account=ABCDEF")</pre>
	</blockquote>
	<!-- -->
</section>

<section id="orders">
	<h2>Retrieving working orders</h2>
	<p>You can use RTD to create custom order books in your spreadsheet. You can use an order set to focus on a particular set of orders and, for each order, include values for columns available in the <a href="ob-reference.html#ob-col-desc">Order Book</a>.</p>

	<p>The RTD formula for retrieving order information uses the following format:</p>
	<!-- -->
	<blockquote>
		<pre>=RTD("tt.rtd",,"Orders",<em>orderbook-columns</em>,<em>num-orders</em>,<em>orderset-id</em>,<em>cell-address</em>)</pre>
	</blockquote>
	<!-- -->
	<p>where:</p>
	<ul>
		<li>
			<em>orderbook-columns</em> is a comma-separated list of one or more Order Book columns whose values you want to return.
		</li>
		<li>
			<em>num-orders</em> indicates the number of working orders to return. You can use the following methods to specify the number:
			<ul>
				<li>
					<strong>"*"</strong> for all working orders matching the selected filter criteria.
				</li>
				<li>
					<strong>"last*<em>n</em>"</strong> or <strong>-<em>n</em></strong> for the <em>n</em> most recent working orders. By using this option, you don't have to handle scrolling lists or to organize the orders, because your spreadsheet always displays the ten most recent orders.
				</li>
				<li>
					<strong>"first*<em>n</em>"</strong> or <strong><em>n</em></strong> for the first <em>n</em> working orders.
				</li>
				<li>
					<strong>"<em>n</em>:<em>m</em>"</strong> for the range of working orders between <em>n</em> and <em>m</em>, inclusively.
				</li>
			</ul>
		</li>
		<li>
			<em>orderset-id</em> is an optional order set ID returned from the <a href="#os">OS formula</a> to filter the orders. If you omit this parameter, you must account for it in the formula with a comma. Also, if you omit this parameter, the formula will return unfiltered orders.
		</li>
		<li>
			<em>cell-address</em> is the address of the internal, temporary spreadsheet that contains the array of values specified by the <em>orderbook-columns</em> parameter
		</li>
	</ul>
	<p>For example, the following RTD formula retrieves values of six columns for the ten most recent orders within the order set referenced in cell B3. It returns the values in a 6x10 array starting in cell E1.</p>
	<!-- -->
	<blockquote>
			<pre>=RTD("tt.rtd",,"Orders","Exch,Product,Contract,OrdQty,Price,Account","last*10",B3, CELL("Address", E1))</pre>
	</blockquote>
	<!-- -->
	
</section>

<section id="fills">
	<h2>Retrieving fills</h2>
	<p>You can use RTD to monitor fills in your spreadsheet. You can use an order set to focus on fills for a particular set of orders and, for each fill, include values for columns available in the <a href="fls-reference.html#fills-col-desc">Fills</a> widget.</p>

		<p>The RTD formula for retrieving fill information uses the following format:</p>

	<!-- -->
	<blockquote>
		<pre>=RTD("tt.rtd",,"Fills",<em>fills-columns</em>,<em>num-fills</em>,<em>orderset-id</em>,<em>cell-address</em>)</pre>
	</blockquote>
	<!-- -->
	<p>where:</p>
	<ul>
		<li>
			<em>fills-columns</em> is a comma-separated list of one or more Fills columns whose values you want to return.
		</li>
		<li>
			<em>num-fills</em> indicates the number of fills to return. You can use the following methods to specify the number:
			<ul>
				<li>
					<strong>"*"</strong> for all fills for orders in the specified order set.
				</li>
				<li>
					<strong>"last*<em>n</em>"</strong> or <strong>-<em>n</em></strong> for the <em>n</em> most recent fills. By using this option, you don't have to handle scrolling lists or to organize the fills, because your spreadsheet always displays the ten most recent fills.
				</li>
				<li>
					<strong>"first*<em>n</em>"</strong> or <strong><em>n</em></strong> for the first <em>n</em> fills.
				</li>
				<li>
					<strong>"<em>n</em>:<em>m</em>"</strong> for the range of fills between <em>n</em> and <em>m</em>, inclusively.
				</li>
			</ul>
		</li>
		<li>
			<em>orderset-id</em> is an optional order set ID returned from the <a href="#os">OS formula</a> to filter the orders. If you omit this parameter, you must account for it in the formula with a comma. Also, if you omit this parameter, the formula will return fills for all orders.
		</li>
		<li>
			<em>cell-address</em> is the address of the internal, temporary spreadsheet that contains the array of values specified by the <em>fills-columns</em> parameter
		</li>
	</ul>
	<p>For example, the following RTD formula retrieves values of seven columns for the ten most recent fills for the orders defined by the order set referenced in cell B3. It returns the values in a 7x10 array starting in cell E1.</p>
		<!-- -->
		<blockquote>
			<pre>=RTD("tt.rtd",,"Fills","Time,Exch,Contract,Price,FillQty,Fill Type,Account","last*10",B3,CELL("Address", E1))</pre>
		</blockquote>
		<!-- -->

</section>