---
widget: xl
layout: task-tab
title: Retrieving instrument properties
AccordionID: xl-retrieving-instrument-properties
---




 <div>
   <!-- <h2>Retrieving instrument properties</h2> -->
    <p>Once you have an instrument ID, you can use the following formula to retrieve properties associated with the instrument:</p>
    <blockquote>
      <pre>=RTD("tt.rtd",,<i>inst-id</i>,<i>property</i>,<i>filter1</i>,<i>filter</i><b>N</b>)</pre>
    </blockquote>

 <div>
  <h2 id="type1-properties">Retrieving instrument properties: type 1</h2>
    <p>Type 1 properties for an instrument are those which return a single value and have no optional filters. They can be extracted with an RTD formula of the form:</p>
    <blockquote>
      <pre>=RTD("tt.rtd",,<i>inst-id</i>,<i>property</i>)</pre>
    </blockquote>
    <p><b>Note</b>: The second parameter is the name of the external server running the RTD Server. As the TT RTD Server always runs locally, you must omit a value for the second parameter or supply an empty string (“”). However, you must account for the parameter in the formula.</p>

    <p>For example, if you stored the string "Last" in cell <b>A13</b> and the instrument ID in cell <b>B3</b>, you could extract the last traded price in TT display format as follows:</p>
    <blockquote>
      <pre>=RTD("tt.rtd",,B3,A13)</pre>
    </blockquote>
    <p>After processing the formula, Excel displays the result in the cell, similar to the following. Note that the "$" in the cell references are Excel mixed reference notations.</p>
    <p><img class="img-responsive" src="Content/rtd-type1.png"></p>

  </div>

  <div>
   <h2 id="type2-properties">Retrieving instrument properties: type 2</h2>
    <p>Type 2 properties for an instrument are those which return a single value and have optional filters. They can be extracted with an RTD formula of the form:</p>
    <blockquote>
      <pre>=RTD("tt.rtd",,<i>inst-id</i>,<i>property</i>,<i>filter1</i>,<i>filter2</i>,<i>filter</i><b>N</b>)</pre>
    </blockquote>
    <p><b>Note</b>: The second parameter is the name of the external server running the RTD Server. As the TT RTD Server always runs locally, you must omit a value for the second parameter or supply an empty string (“”). However, you must account for the parameter in the formula.</p>

     <p>You can use the <b>Account</b> attribute as a filter to limit the fills for which the TT RTD Server calculates values. For example, you might want the quantity of sell orders (<b>SellQty</b> property) of an instrument only if it was submitted through a specific account (<b>Account</b> attribute).</p>
    <p><b>Note</b>: As noted, you must specify at least one <b>Account</b> filter for some type 2 properties.</p>
    <p>The format for a filter parameter in the formula is:</p>
    <p><pre>&lt;property&gt;&lt;operator&gt;&lt;value&gt;</pre></p>
    <p>For example, if you stored the string "AvgOpenPrice#" in cell <b>A33</b>, the string "Account="ATRSim" in cell <b>A31</b>, and the instrument ID in cell <b>B3</b>, you could extract the average open price in decimal as follows:</p>
    <blockquote>
      <pre>=RTD("tt.rtd",,B3,A33,A31)</pre>
    </blockquote>
    <p>After processing the formula, Excel displays the result in the cell, similar to the following. Note that the "$" in the cell references are Excel mixed reference notations.</p>
    <p><img class="img-responsive" src="Content/rtd-type2-single-filter.png"></p>
    </div>



 </div>